!function(){function showDashboard(){internship(myself.Email,function(i){mine=i;for(x in i.Reports){var delivered=new Date(i.Reports[x].Delivery).getTime()>0;i.Reports[x].Uploaded=delivered;var passed=new Date(i.Reports[x].Deadline).getTime()+864e5<(new Date).getTime();i.Reports[x].Locked=passed&&delivered||i.Reports[x].Grade>=0}var html=Handlebars.getTemplate("internship")(i),root=$("#cnt");root.html(html),$("#select-position").selecter(),$("#major").selecter({callback:function(v){setMajor(mine.Student.Email,v)}}),$("input[type=file]").filestyle({input:!1,buttonText:"",buttonName:"btn-success btn-sm",iconName:"glyphicon-cloud-upload",badge:!1}),$(":file").change(function(){var file=this.files[0],size=(file.name,file.size),type=file.type;if("application/pdf"!=type)reportError("The report must be in PDF format");else if(size>1e7)reportError("The report cannot exceed 10MB");else{var formData=new FormData;formData.append("report",file);var html=Handlebars.getTemplate("upload-progress")(mine),root=$("#modal-hard");root.html(html).modal({backdrop:"static",keyboard:!1,show:!0}),setReportContent(mine.Student.Email,$(this).attr("data-kind"),formData,showProgress,function(){$("#modal-hard").modal("hide"),reportSuccess("Report uploaded"),showDashboard()},function(o){$("#modal-hard").modal("hide"),reportError(o.responseText)})}})})}function showProgress(evt){if(evt.lengthComputable){var pct=evt.loaded/evt.total*100;$("#progress-value").html(Math.round(pct)+"%"),$("#progress-value").attr("aria-valuenow",pct),$("#progress-value").css("width",pct+"%")}else console.log("unable to complete")}var mine;$(document).ready(function(){waitingBlock=$("#cnt").clone().html(),majors(function(m){allMajors=m}),user(getCookie("session"),function(u){myself=u,$("#fullname").html(u.Firstname+" "+u.Lastname),showDashboard()})})}();